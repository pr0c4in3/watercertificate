# 工作进度
## 7.1
- 设计数字水印算法：
  - 嵌入过程：
（1）对原始图像进行离散小波变换，得到小波系数；
（2）选择合适的小波系数作为嵌入位置，修改这些系数以嵌入水印信息；
（3）对修改后的小波系数进行逆离散小波变换，得到嵌入水印后的图像。
  - 提取过程：
（1）对含有水印的图像进行离散小波变换，得到小波系数；
（2）从修改过的小波系数中提取出水印信息；
（3）使用逆离散小波变换还原原始图像。

- 写了接口web类用于封装传入图片和保存图片的逻辑，目前的逻辑是传入图片后建立随机文件夹（1~99999/in）保存用户传入的图片，写文件过滤白名单用于防止用户传入恶意代码。随机文件夹名之后应修改为字典，需要查重的功能，可以通过数据库实现。
- web类还实现了连接底层代码（watermaek_extract.py,watermark_embed.py）的功能，为后端网页管理器（back.py）提供接口，back.py只需要调用extract和embed相关函数和保存函数即可，在之后实现数据库操作中也做好了接口的准备。
- 跑通了web.py的逻辑，完成了提取水印的操作。解决了对象为None的bug，发现问题为提取水印时：<br>
保存文件的路径（用户发的文件存下来）和提取保存的文件路径（提取刚才的文件）不一致，所以找不到文件报错。
- 将底层图像处理代码接口扩展，比如提取水印算法，需要提供水印长度，在计算时应该是按一个字节8位来算，在函数中进行预处理，使得参数可以是直观的水印的字数而不是水印字数乘8再-1，更加直观。
- 写了数字水印证书选题介绍.md，重新架构本项目，设计出一套基于dwt数字水印的图片数字证书颁发管理系统，用于网络中图片版权的保护和管理。
- 建立Github仓库库用于版本管理，完善文档
  
## 7.2
- 和组员核对进度，分配任务。安排了前端证书管理页面，登入登出页面，上传图片添加水印提取水印（修改）的任务，安排了后端登录流程处理的任务。
- 完成了DAO层数据管理文件dbctrl.py 定义了两个类ca_db,login_db,负责管理证书数据库和用户数据库。
- 将陈奕枫写的登录代码和李睿涵写的登录页面整合，跑通了登录的过程，修改了部分前后端接口，比如登录的会话session，将前端访问的路径改为后端中定义的，修改部分json格式。
- 完善了依赖文档requirement.py，将需要安装的依赖记录其中
- 将提交图片添加水印的流程添加入数据库中，这之后提交图片后图片路径，用户等信息被写入DAO层定义的表中。为已上传的证书查询证书管理功能做准备。
- 整合了叶宝骏写的证书管理页面，跑通了证书查询的功能，当路径为manager时可以显示出目前用户的所有证书的部分信息。
- 修改登录后的前端页面，在左上角显示用户名（表示登录状态），后端flask需要在返回的页面中加上`username=username1`（定义为`username1=session['username']`(也就是当前的会话用户)）
- 安排7.3的工作为实现对证书的删查，提取水印添加通过提取的水印查询已有证书的功能，使用该功能用户可以证明自己对图片的知识产权。